%% Arquitectura por componentes/capas
flowchart LR
%% Estilos
classDef boundary fill:#eef,stroke:#55f,color:#000
classDef control fill:#efe,stroke:#5a5,color:#000
classDef entity fill:#fee,stroke:#a55,color:#000
classDef gateway fill:#ffd,stroke:#aa5,color:#000
classDef datasource fill:#f4f4f4,stroke:#999,color:#000

subgraph Presentation[Presentación]
  AppCli[CLI]
end

subgraph Application[Aplicación]
  AuthService
  AdminService
  OrganizerService
  CatalogService
  OfferService
  PurchaseService
  TransferService
  DataSeeder
end

subgraph Domain[Dominio]
  subgraph DomainModel[Modelo]
    Usuario
    Administrador
    ClienteComprador
    Organizador
    Venue
    Evento
    Localidad
    Asiento
    Oferta
    Tiquete
    TiqueteBasico
    TiqueteNumerado
    TiqueteAgrupacion
    TiqueteMultiple
    PaqueteDeluxe
  end
  subgraph DomainService[Servicios de dominio]
    OfferEngine
    PricingPolicy
    DefaultPricingPolicy
    TicketFactory
    PriceBreakdown
    IdGenerator
  end
  subgraph DomainRepository[Repositorios (interfaces)]
    UsuarioRepository
    VenueRepository
    EventoRepository
    LocalidadRepository
    AsientoRepository
    OfertaRepository
    TiqueteRepository
    TiqueteAgregadoRepository
  end
end

subgraph Infrastructure[Infraestructura CSV]
  CsvUsuarioRepository
  CsvVenueRepository
  CsvEventoRepository
  CsvLocalidadRepository
  CsvAsientoRepository
  CsvOfertaRepository
  CsvTiqueteRepository
  CsvTiqueteAgregadoRepository
  CSVUtil
  CsvFormat
  CsvPaths
end

%% Presentación → Servicios de aplicación
AppCli --> AuthService
AppCli --> AdminService
AppCli --> OrganizerService
AppCli --> CatalogService
AppCli --> TransferService
AppCli --> PurchaseService

%% Servicios de aplicación → Repositorios (interfaces)
AuthService --> UsuarioRepository
AdminService --> UsuarioRepository
AdminService --> VenueRepository
OrganizerService --> VenueRepository
OrganizerService --> EventoRepository
OrganizerService --> LocalidadRepository
OrganizerService --> AsientoRepository
OrganizerService --> OfertaRepository
CatalogService --> VenueRepository
CatalogService --> EventoRepository
CatalogService --> LocalidadRepository
OfferService --> OfertaRepository
PurchaseService --> UsuarioRepository
PurchaseService --> LocalidadRepository
PurchaseService --> OfertaRepository
PurchaseService --> AsientoRepository
PurchaseService --> TiqueteRepository
TransferService --> TiqueteRepository
DataSeeder --> UsuarioRepository
DataSeeder --> VenueRepository
DataSeeder --> EventoRepository
DataSeeder --> LocalidadRepository
DataSeeder --> AsientoRepository
DataSeeder --> OfertaRepository

%% Servicios de aplicación → Servicios/Modelo de dominio
PurchaseService --> OfferEngine
PurchaseService --> PricingPolicy
TicketFactory --> IdGenerator

%% Implementaciones CSV de repositorios
UsuarioRepository -. implements .-> CsvUsuarioRepository
VenueRepository -. implements .-> CsvVenueRepository
EventoRepository -. implements .-> CsvEventoRepository
LocalidadRepository -. implements .-> CsvLocalidadRepository
AsientoRepository -. implements .-> CsvAsientoRepository
OfertaRepository -. implements .-> CsvOfertaRepository
TiqueteRepository -. implements .-> CsvTiqueteRepository
TiqueteAgregadoRepository -. implements .-> CsvTiqueteAgregadoRepository

%% Clasificación visual
AppCli:::boundary
AuthService:::control
AdminService:::control
OrganizerService:::control
CatalogService:::control
OfferService:::control
PurchaseService:::control
TransferService:::control
DataSeeder:::control
Usuario:::entity
Administrador:::entity
ClienteComprador:::entity
Organizador:::entity
Venue:::entity
Evento:::entity
Localidad:::entity
Asiento:::entity
Oferta:::entity
Tiquete:::entity
TiqueteBasico:::entity
TiqueteNumerado:::entity
TiqueteAgrupacion:::entity
TiqueteMultiple:::entity
PaqueteDeluxe:::entity
UsuarioRepository:::gateway
VenueRepository:::gateway
EventoRepository:::gateway
LocalidadRepository:::gateway
AsientoRepository:::gateway
OfertaRepository:::gateway
TiqueteRepository:::gateway
TiqueteAgregadoRepository:::gateway
CsvUsuarioRepository:::datasource
CsvVenueRepository:::datasource
CsvEventoRepository:::datasource
CsvLocalidadRepository:::datasource
CsvAsientoRepository:::datasource
CsvOfertaRepository:::datasource
CsvTiqueteRepository:::datasource
CsvTiqueteAgregadoRepository:::datasource
CSVUtil:::datasource
CsvFormat:::datasource
CsvPaths:::datasource


